function factory(t){var e={innerRadiusSize:.7,showTooltip:!0,showLabels:!1,sort:!1,colors:["#004A7C","#CDFC41","#A2A2A1"],transition:700,initialTransition:!1,percents:!1,showOtherTooltip:!1,otherSize:1};return function o(s,i){if(!(this instanceof o))return new o(s,i);this.options=Object.assign(e,i);var n=this,a=document.querySelector(s),r=t.select(s),l=t.select(s).append("svg"),p=l.append("g");r.style("position","relative").style("display","flex").style("justify-content","center").style("align-items","center"),l.style("position","absolute").style("top","0").style("left","0");var u,h,d,c,f=t.pie().value(function(t){return t.value}).sort(null),y=!1;if(this.options.showTooltip){var v=r.append("div").attr("class","tooltip").style("position","absolute").style("display","none").style("pointer-events","none");v.append("div").attr("class","tooltip-label"),v.append("div").attr("class","tooltip-value")}this.update=function(){if("number"==typeof this.options.values&&(this.options.values=[this.options.values]),"undefined"!=typeof this.options.values&&(this.options.dataset=[],this.options.values.forEach(function(t,e){n.options.dataset.push({value:t,label:"undefined"!=typeof n.options.labels?n.options.labels[e]:""})}),delete this.options.values,delete this.options.labels),"boolean"==typeof this.options.percents&&this.options.percents){var e=this.options.dataset.map(function(t){return t.value}).reduce(function(t,e){return t+e});100>e&&this.options.dataset.push({value:100-e,label:"Other"})}if("boolean"==typeof this.options.sort&&this.options.sort&&this.options.dataset.length>1&&this.options.dataset.sort(function(t,e){return e.value-t.value}),this.options.initialTransition&&!y){var o=JSON.stringify(this.options);this.options.sort=!1,this.options.showLabels=!1,this.options.dataset.forEach(function(t,e){t.value=e===n.options.dataset.length-1?100:0}),setTimeout(function(){y=!0,n.options=JSON.parse(o),n.update()},0)}var s=p.selectAll(".segment").data(f(this.options.dataset));s.exit().remove();var i=s.enter().append("g").attr("class","segment");i.append("path"),i.append("text");var a=i.merge(s);u=a.select("path"),"boolean"==typeof this.options.showLabels&&this.options.showLabels&&(h=a.select("text").text(function(t){return t.data.label}).style("font-size",".8em").attr("class","chart-label")),c=(this.options.dataset.length-1)/(this.options.colors.length-1),d=t.scaleLinear().domain(this.options.colors.map(function(t,e){return e*c})).interpolate(t.interpolateHcl).range(this.options.colors.map(function(e){return t.rgb(e)})),u.attr("fill",function(t,e){return d(e)}),this.render()}.bind(this),this.render=function(){var e=parseInt(r.style("width")),o=e>600?e/1.5:e,s=Math.min(e,o)/2,i=s*this.options.innerRadiusSize;r.style("height",o+"px"),l.attr("width",e).attr("height",o),p.attr("transform","translate("+e/2+","+o/2+")");var d=t.arc().innerRadius(function(t){return"Other"===t.data.label&&i>0?i+(s-i)*(1-n.options.otherSize)/2:i}).outerRadius(function(t){return"Other"===t.data.label?s-(s-i)*(1-n.options.otherSize)/2:s});if("boolean"==typeof this.options.showLabels&&this.options.showLabels){var c=s-25,f=t.arc().innerRadius(c).outerRadius(c);h.attr("transform",function(t){return"translate("+f.centroid(t)+")"}).attr("dy","0.35em").attr("dx",function(t){var e=f.centroid(t);return e[0]>0?(-(10*t.data.label.length)*f.centroid(t)[0]/s).toFixed(0)+"px":"0px"})}"boolean"==typeof this.options.transition&&this.options.transition&&(this.options.transition=this.defaultOptions.transition),"number"==typeof this.options.transition&&this.options.transition?u.transition().duration(this.options.transition).attrTween("d",function(e){var o=t.interpolate(this._current,e);return this._current=o(0),function(t){return d(o(t))}}):u.attr("d",d),"boolean"==typeof this.options.showTooltip&&this.options.showTooltip&&(u.on("mouseover",function(t){"Other"!==t.data.label&&(v.style("display","block"),v.select(".tooltip-label").text(t.data.label),v.select(".tooltip-value").text(n.options.percents?t.data.value+"%":t.data.value))}),a.addEventListener("mousemove",function(t){var s=t.layerY,i=t.layerX,n=o/2>s?s+20:s-parseInt(v.style("height"))-parseInt(v.style("padding-top"))-parseInt(v.style("padding-bottom"))-20,a=e/2>i?i+20:i-parseInt(v.style("width"))-parseInt(v.style("padding-left"))-parseInt(v.style("padding-right"))-20;v.style("top",n+"px").style("left",a+"px")}),u.on("mouseout",function(){v.style("display","none")}))}.bind(this),this.update(),t.select(window).on("resize."+s.replace(/[^a-z0-9_-]/gi,""),this.render)}}!function(t,e){if("function"==typeof define&&define.amd)define(["d3"],e);else if("object"==typeof module&&module.exports){var o=Object.assign({},require("d3-scale"),require("d3-selection"),require("d3-shape"),require("d3-color"),require("d3-interpolate"));module.exports=e(o)}else t.SvgPie=e(t.d3)}(this,factory);